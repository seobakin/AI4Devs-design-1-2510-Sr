# LTI - Applicant Tracking System del Futuro para Startups

## √çndice

1. [Descripci√≥n del Software](#1-descripci√≥n-del-software)
2. [Funciones Principales](#2-funciones-principales)
3. [Lean Canvas](#3-lean-canvas)
4. [Casos de Uso Principales](#4-casos-de-uso-principales)
5. [Modelo de Datos](#5-modelo-de-datos)
6. [Dise√±o del Sistema a Alto Nivel](#6-dise√±o-del-sistema-a-alto-nivel)
7. [Diagrama C4 - Componente de IA](#7-diagrama-c4---componente-de-ia)

---

## 1. Descripci√≥n del Software

### ¬øQu√© es LTI?

**LTI (Leading Talent Intelligence)** es un Applicant Tracking System (ATS) de nueva generaci√≥n dise√±ado espec√≠ficamente para startups en fase de crecimiento. A diferencia de los ATS tradicionales que fueron construidos para grandes corporaciones y luego simplificados, LTI nace desde cero con la mentalidad startup: simplicidad radical, IA nativa y pricing transparente.

### Valor A√±adido

LTI resuelve los tres problemas fundamentales que enfrentan las startups al contratar:

1. **Tiempo escaso**: Los founders y equipos peque√±os no pueden dedicar horas a aprender sistemas complejos. LTI ofrece onboarding en menos de 30 minutos con una interfaz que no requiere formaci√≥n.

2. **Presupuesto limitado**: Mientras los ATS enterprise cuestan $35,000+/a√±o, LTI es gratuito hasta 10 contrataciones anuales y escala con el √©xito de la empresa, no con el n√∫mero de usuarios.

3. **Competencia por talento tech**: Las startups compiten contra Google y Meta por los mismos desarrolladores. LTI nivela el campo con herramientas de IA que automatizan el sourcing, personalizan el outreach y optimizan cada etapa del funnel.

### Ventajas Competitivas

| Caracter√≠stica | LTI | Greenhouse | Lever | Workable |
|----------------|-----|------------|-------|----------|
| **Onboarding** | < 30 min | Semanas | D√≠as | D√≠as |
| **Precio inicial** | Gratis | $6,500/a√±o | Custom | $299/mes |
| **IA nativa** | ‚úÖ Integrada | ‚ùå Plugins | ‚ùå B√°sica | ‚ùå Add-on |
| **Pricing transparente** | ‚úÖ P√∫blico | ‚ùå Llamada ventas | ‚ùå Llamada ventas | ‚úÖ P√∫blico |
| **Mobile-first** | ‚úÖ Completo | ‚ö†Ô∏è Limitado | ‚ö†Ô∏è Limitado | ‚ö†Ô∏è Limitado |
| **Slack nativo** | ‚úÖ Workflow completo | ‚ö†Ô∏è Notificaciones | ‚ö†Ô∏è Notificaciones | ‚ö†Ô∏è Notificaciones |

**Diferenciadores √∫nicos de LTI:**

- **AI Agent 24/7**: Mientras el equipo duerme, el agente de IA sourcea candidatos, env√≠a mensajes personalizados y programa screenings iniciales.
- **GitHub/Portfolio Import**: Enriquecimiento autom√°tico de perfiles t√©cnicos con an√°lisis de repositorios y proyectos.
- **Interview Copilot**: Sugerencias de preguntas en tiempo real durante entrevistas basadas en el CV y respuestas anteriores.
- **Candidate Rediscovery**: IA que autom√°ticamente resurface candidatos pasados cuando abres un nuevo rol compatible.
- **One-Click Job Post**: La IA genera la descripci√≥n del puesto y la publica en 15+ job boards simult√°neamente.

---

## 2. Funciones Principales

### 2.1 Gesti√≥n de Ofertas de Empleo

**Creaci√≥n asistida por IA**: El usuario describe el rol en lenguaje natural y la IA genera una job description optimizada para SEO y conversi√≥n, incluyendo requisitos, responsabilidades, beneficios y cultura.

**Multi-posting autom√°tico**: Publicaci√≥n simult√°nea en LinkedIn, Indeed, Glassdoor, Stack Overflow Jobs, AngelList, y job boards especializados por sector.

**Career Site Builder**: Constructor drag-and-drop de p√°ginas de carreras con templates modernos, testimonios de empleados auto-generados y analytics de conversi√≥n.

### 2.2 Sourcing Inteligente

**AI Agent de Sourcing**: Agente aut√≥nomo que busca candidatos en LinkedIn, GitHub, Stack Overflow y otras fuentes 24/7, evaluando fit t√©cnico y cultural.

**Outreach Personalizado**: Generaci√≥n autom√°tica de mensajes de contacto que mencionan proyectos espec√≠ficos del candidato, papers publicados o contribuciones open source.

**Talent Pool CRM**: Base de datos de candidatos pasados con nurturing automatizado, scoring din√°mico y alertas de disponibilidad.

### 2.3 Pipeline de Candidatos

**Kanban Visual**: Vista de pipeline drag-and-drop con stages personalizables por rol (Applied ‚Üí Screening ‚Üí Technical ‚Üí Culture ‚Üí Offer ‚Üí Hired).

**Automatizaciones**: Workflows configurables que mueven candidatos, env√≠an emails, notifican al equipo y programan entrevistas autom√°ticamente.

**Bulk Actions**: Acciones masivas sobre candidatos con filtros avanzados (rechazar, mover stage, enviar template, a√±adir tags).

### 2.4 Evaluaci√≥n y Entrevistas

**Scorecards Estructurados**: Templates de evaluaci√≥n por competencias con escalas configurables, campos de evidencia y recomendaci√≥n final.

**Interview Scheduling**: Self-scheduling para candidatos con disponibilidad del equipo, integraci√≥n con Google Calendar/Outlook y recordatorios autom√°ticos.

**Interview Copilot**: Durante la entrevista, sugerencias de preguntas follow-up basadas en respuestas, gaps detectados en CV y criterios del scorecard.

**Video Interviews**: Entrevistas as√≠ncronas con preguntas predefinidas, l√≠mites de tiempo y transcripci√≥n autom√°tica con an√°lisis de IA.

### 2.5 Colaboraci√≥n en Tiempo Real

**Slack/Teams Native**: Workflow completo sin salir del chat - aprobar candidatos, ver CVs resumidos, dar feedback, recibir alertas.

**Feedback Consolidado**: La IA sintetiza todos los scorecards en un resumen ejecutivo con fortalezas, debilidades y recomendaci√≥n.

**Hiring Manager Portal**: Vista simplificada para managers no-recruiters con acciones one-click y dashboards de sus posiciones.

**@Mentions y Comentarios**: Comunicaci√≥n contextual en cada candidato con historial completo y notificaciones inteligentes.

### 2.6 Analytics y Reporting

**Dashboard en Tiempo Real**: M√©tricas clave (time-to-hire, source effectiveness, pipeline velocity, offer acceptance rate) con comparativas hist√≥ricas.

**Funnel Analytics**: An√°lisis de conversi√≥n por stage, identificaci√≥n de cuellos de botella y predicciones de tiempo de contrataci√≥n.

**DE&I Reporting**: M√©tricas de diversidad en pipeline con anonymizaci√≥n opcional y detecci√≥n de bias en proceso.

**Custom Reports**: Builder de reportes con filtros avanzados, exportaci√≥n a Excel/PDF y scheduling de env√≠o autom√°tico.

### 2.7 Ofertas y Onboarding

**Offer Management**: Templates de cartas de oferta con variables din√°micas, firma electr√≥nica integrada y tracking de estado.

**Salary Benchmarking**: Datos de mercado integrados con recomendaciones de rango salarial por rol, ubicaci√≥n y seniority.

**Pre-boarding**: Checklist automatizado post-aceptaci√≥n con documentaci√≥n, accesos y welcome package.

---

## 3. Lean Canvas

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'fontSize': '14px'}}}%%
flowchart TB
    subgraph canvas[" "]
        direction TB
        
        subgraph row1[" "]
            direction LR
            subgraph problem["üî¥ PROBLEMA"]
                p1["1. ATS enterprise muy caros<br/>($35K+/a√±o)"]
                p2["2. Curva aprendizaje<br/>pronunciada"]
                p3["3. IA a√±adida como plugin,<br/>no nativa"]
            end
            
            subgraph solution["üü¢ SOLUCI√ìN"]
                s1["1. Gratis hasta 10<br/>contrataciones/a√±o"]
                s2["2. Onboarding < 30 min,<br/>zero-training"]
                s3["3. IA integrada desde<br/>arquitectura"]
            end
            
            subgraph uvp["‚≠ê PROPUESTA DE VALOR √öNICA"]
                uvp1["El ATS que contrata<br/>mientras duermes"]
                uvp2["IA nativa + Simplicidad radical<br/>+ Pricing transparente"]
            end
            
            subgraph advantage["üè∞ VENTAJA COMPETITIVA"]
                a1["AI Agent aut√≥nomo 24/7"]
                a2["GitHub/Portfolio enrichment"]
                a3["Interview Copilot √∫nico"]
            end
            
            subgraph segments["üë• SEGMENTOS"]
                seg1["Startups tech 10-200<br/>empleados"]
                seg2["Series A-B en<br/>scaling"]
                seg3["Founders/COOs sin<br/>dept. RRHH"]
            end
        end
        
        subgraph row2[" "]
            direction LR
            subgraph metrics["üìä M√âTRICAS CLAVE"]
                m1["‚Ä¢ MRR / ARR"]
                m2["‚Ä¢ Contrataciones/mes"]
                m3["‚Ä¢ NPS usuarios"]
                m4["‚Ä¢ Time-to-hire clientes"]
            end
            
            subgraph channels["üì¢ CANALES"]
                c1["‚Ä¢ Product Hunt launch"]
                c2["‚Ä¢ Partnerships YC/Techstars"]
                c3["‚Ä¢ Content marketing SEO"]
                c4["‚Ä¢ Referrals de VCs"]
            end
        end
        
        subgraph row3[" "]
            direction LR
            subgraph costs["üí∞ ESTRUCTURA DE COSTES"]
                cost1["‚Ä¢ Infraestructura cloud (AWS/GCP)"]
                cost2["‚Ä¢ APIs de IA (OpenAI, Anthropic)"]
                cost3["‚Ä¢ Integraciones (LinkedIn, job boards)"]
                cost4["‚Ä¢ Equipo desarrollo y soporte"]
            end
            
            subgraph revenue["üíµ FUENTES DE INGRESOS"]
                rev1["‚Ä¢ Freemium: Gratis hasta 10 hires/a√±o"]
                rev2["‚Ä¢ Growth: $299/mes (50 hires/a√±o)"]
                rev3["‚Ä¢ Scale: $599/mes (unlimited)"]
                rev4["‚Ä¢ Enterprise: Custom + SLA"]
            end
        end
    end
    
    style problem fill:#ffebee
    style solution fill:#e8f5e9
    style uvp fill:#fff3e0
    style advantage fill:#e3f2fd
    style segments fill:#f3e5f5
    style metrics fill:#e0f7fa
    style channels fill:#fce4ec
    style costs fill:#efebe9
    style revenue fill:#e8f5e9
```

### Explicaci√≥n del Lean Canvas

**Problema**: El mercado de ATS tiene menos del 50% de satisfacci√≥n. Las startups enfrentan herramientas caras dise√±adas para enterprises, interfaces complejas que requieren semanas de training, y funcionalidades de IA que son plugins superficiales sin integraci√≥n real.

**Soluci√≥n**: LTI ataca cada problema directamente con modelo freemium agresivo, UX obsesivamente simple, e IA como ciudadano de primera clase en la arquitectura.

**Propuesta de Valor √önica**: "El ATS que contrata mientras duermes" captura la esencia del AI Agent aut√≥nomo que sourcea, contacta y pre-filtra candidatos 24/7.

**Ventaja Competitiva**: Ning√∫n competidor ofrece simult√°neamente un agente de IA aut√≥nomo, integraci√≥n profunda con ecosistemas de desarrollo (GitHub), y asistencia en tiempo real durante entrevistas.

**Segmentos**: Focus l√°ser en startups tech en fase de scaling donde cada contrataci√≥n es cr√≠tica y los recursos de HR son limitados o inexistentes.

**M√©tricas Clave**: MRR como norte financiero, contrataciones exitosas como m√©trica de valor entregado, NPS para product-market fit, y time-to-hire de clientes como prueba de eficacia.

**Canales**: Go-to-market product-led con virality en comunidades startup (Product Hunt, YC, Techstars) complementado con content marketing para SEO.

**Estructura de Costes**: Modelo SaaS t√≠pico con costes variables por uso de APIs de IA y fijos de infraestructura y equipo.

**Fuentes de Ingresos**: Freemium para adquisici√≥n, tiers claros por volumen de contrataci√≥n, y enterprise para grandes cuentas con necesidades custom.

---

## 4. Casos de Uso Principales

### 4.1 Caso de Uso 1: Publicaci√≥n de Oferta de Empleo con IA

**Actor Principal**: Recruiter / Hiring Manager

**Descripci√≥n**: El usuario necesita publicar una nueva oferta de empleo. En lugar de escribir manualmente la job description y publicarla en cada job board individualmente, utiliza el sistema de IA de LTI para generar el contenido y publicar autom√°ticamente en m√∫ltiples plataformas.

**Precondiciones**:
- Usuario autenticado con permisos de creaci√≥n de ofertas
- Al menos un departamento configurado en el sistema
- Integraciones con job boards activas

**Flujo Principal**:
1. Usuario accede a "Nueva Oferta"
2. Usuario introduce t√≠tulo del puesto y descripci√≥n b√°sica en lenguaje natural
3. Sistema genera job description completa con IA (requisitos, responsabilidades, beneficios)
4. Usuario revisa y edita el contenido generado
5. Usuario selecciona job boards de destino
6. Sistema publica simult√°neamente en todos los canales seleccionados
7. Sistema confirma publicaci√≥n y muestra enlaces

**Flujos Alternativos**:
- 3a. Usuario no est√° satisfecho con la generaci√≥n ‚Üí Regenera con instrucciones adicionales
- 5a. Integraci√≥n con job board falla ‚Üí Sistema notifica y permite reintentar
- 6a. Usuario quiere programar publicaci√≥n ‚Üí Sistema permite fecha/hora futura

**Postcondiciones**:
- Oferta activa en el sistema y visible en career site
- Publicaciones activas en job boards seleccionados
- Pipeline de candidatos creado para la oferta

```mermaid
sequenceDiagram
    autonumber
    actor R as Recruiter
    participant UI as LTI Frontend
    participant API as LTI API
    participant AI as AI Service
    participant JB as Job Boards API
    participant DB as Database

    R->>UI: Accede a "Nueva Oferta"
    UI->>R: Muestra formulario simplificado
    
    R->>UI: Introduce t√≠tulo y descripci√≥n b√°sica
    UI->>API: POST /jobs/generate
    API->>AI: Genera job description
    AI-->>API: JD completa (requisitos, responsabilidades, beneficios)
    API-->>UI: Muestra preview de JD
    
    R->>UI: Revisa y aprueba contenido
    R->>UI: Selecciona job boards (LinkedIn, Indeed, etc.)
    
    UI->>API: POST /jobs/publish
    API->>DB: Guarda oferta
    DB-->>API: Job ID
    
    par Publicaci√≥n paralela
        API->>JB: Publica en LinkedIn
        API->>JB: Publica en Indeed
        API->>JB: Publica en Glassdoor
    end
    
    JB-->>API: Confirmaciones de publicaci√≥n
    API->>DB: Actualiza estado publicaciones
    API-->>UI: Resumen de publicaciones
    UI-->>R: Muestra confirmaci√≥n con enlaces
```

---

### 4.2 Caso de Uso 2: Screening Automatizado de Candidatos

**Actor Principal**: Sistema (AI Agent) / Recruiter (supervisi√≥n)

**Descripci√≥n**: Cuando llegan nuevas aplicaciones, el AI Agent de LTI analiza autom√°ticamente los CVs, eval√∫a el fit con los requisitos del puesto, enriquece los perfiles con datos externos (GitHub, LinkedIn), y pre-filtra candidatos clasific√°ndolos por prioridad. El recruiter supervisa y puede ajustar las decisiones del sistema.

**Precondiciones**:
- Oferta de empleo activa con requisitos definidos
- AI Agent de screening activado para la oferta
- Permisos de auto-screening configurados

**Flujo Principal**:
1. Candidato aplica a trav√©s de career site o job board
2. Sistema recibe aplicaci√≥n y CV
3. AI Agent parsea CV extrayendo datos estructurados
4. AI Agent busca perfiles p√∫blicos del candidato (LinkedIn, GitHub)
5. AI Agent eval√∫a match con requisitos del puesto
6. Sistema clasifica candidato (Hot/Warm/Cold) y asigna score
7. Sistema mueve candidato al stage correspondiente del pipeline
8. Sistema notifica al recruiter de candidatos prioritarios

**Flujos Alternativos**:
- 3a. CV en formato no soportado ‚Üí Sistema solicita re-upload
- 4a. No se encuentran perfiles p√∫blicos ‚Üí Contin√∫a solo con datos del CV
- 6a. Score bajo umbral ‚Üí Sistema rechaza autom√°ticamente con email personalizado
- 8a. Candidato Hot ‚Üí Sistema programa screening call autom√°ticamente

**Postcondiciones**:
- Candidato en pipeline con score y clasificaci√≥n
- Perfil enriquecido con datos externos
- Recruiter notificado si es candidato prioritario
- M√©tricas de funnel actualizadas

```mermaid
sequenceDiagram
    autonumber
    actor C as Candidato
    participant CS as Career Site
    participant API as LTI API
    participant AI as AI Agent
    participant EXT as APIs Externas
    participant DB as Database
    participant N as Notifications
    actor R as Recruiter

    C->>CS: Aplica a oferta
    CS->>API: POST /applications
    API->>DB: Guarda aplicaci√≥n
    API->>AI: Trigger screening
    
    rect rgb(240, 248, 255)
        Note over AI: Proceso de Screening Autom√°tico
        AI->>AI: Parsea CV (NLP)
        AI->>EXT: Busca perfil LinkedIn
        EXT-->>AI: Datos LinkedIn
        AI->>EXT: Busca perfil GitHub
        EXT-->>AI: Repos y contribuciones
        AI->>AI: Eval√∫a match con requisitos
        AI->>AI: Calcula score (0-100)
    end
    
    AI->>DB: Actualiza perfil enriquecido
    AI->>DB: Guarda score y clasificaci√≥n
    
    alt Score >= 80 (Hot)
        AI->>DB: Mueve a "Screening" stage
        AI->>N: Alerta prioritaria
        N->>R: Push notification + Slack
    else Score 50-79 (Warm)
        AI->>DB: Mantiene en "Applied"
        AI->>N: Notificaci√≥n est√°ndar
        N->>R: Email resumen diario
    else Score < 50 (Cold)
        AI->>DB: Mueve a "Rejected"
        AI->>N: Email rechazo personalizado
        N->>C: Email de agradecimiento
    end
    
    R->>API: GET /candidates/{id}
    API-->>R: Perfil completo con score y an√°lisis
```

---

### 4.3 Caso de Uso 3: Evaluaci√≥n Colaborativa Post-Entrevista

**Actor Principal**: Entrevistadores (m√∫ltiples) / Hiring Manager

**Descripci√≥n**: Despu√©s de una ronda de entrevistas, m√∫ltiples entrevistadores deben completar sus scorecards de forma independiente. El sistema consolida el feedback, la IA genera un resumen ejecutivo con an√°lisis de consenso/discrepancias, y el hiring manager toma la decisi√≥n final de avanzar o rechazar al candidato.

**Precondiciones**:
- Entrevista completada con m√∫ltiples entrevistadores
- Scorecards configurados para el tipo de entrevista
- Todos los entrevistadores con acceso al sistema

**Flujo Principal**:
1. Sistema env√≠a recordatorio post-entrevista a entrevistadores
2. Cada entrevistador accede a su scorecard pendiente
3. Entrevistador completa evaluaci√≥n por competencias
4. Entrevistador a√±ade notas y recomendaci√≥n final
5. Sistema detecta cuando todos los scorecards est√°n completos
6. AI consolida feedback y genera resumen ejecutivo
7. Sistema notifica al Hiring Manager
8. Hiring Manager revisa resumen y toma decisi√≥n
9. Sistema actualiza estado del candidato y notifica al equipo

**Flujos Alternativos**:
- 2a. Entrevistador no completa en 24h ‚Üí Sistema env√≠a recordatorio
- 4a. Evaluaciones muy discrepantes ‚Üí Sistema alerta para calibraci√≥n
- 8a. Hiring Manager solicita entrevista adicional ‚Üí Sistema programa nueva ronda
- 8b. Decisi√≥n es avanzar ‚Üí Sistema genera y env√≠a oferta

**Postcondiciones**:
- Scorecards completos y consolidados
- Resumen ejecutivo disponible
- Candidato movido al siguiente stage o rechazado
- Historial de decisi√≥n documentado para compliance

```mermaid
sequenceDiagram
    autonumber
    participant S as Sistema
    participant N as Notifications
    actor E1 as Entrevistador 1
    actor E2 as Entrevistador 2
    actor E3 as Entrevistador 3
    participant API as LTI API
    participant AI as AI Service
    participant DB as Database
    actor HM as Hiring Manager

    Note over S: Entrevista finalizada
    S->>N: Trigger recordatorios
    
    par Notificaciones paralelas
        N->>E1: Email + Slack: Completar scorecard
        N->>E2: Email + Slack: Completar scorecard
        N->>E3: Email + Slack: Completar scorecard
    end
    
    rect rgb(255, 248, 240)
        Note over E1,E3: Evaluaci√≥n independiente (sin ver otros scores)
        E1->>API: POST /scorecards (competencias + notas + recomendaci√≥n)
        E2->>API: POST /scorecards (competencias + notas + recomendaci√≥n)
        E3->>API: POST /scorecards (competencias + notas + recomendaci√≥n)
    end
    
    API->>DB: Guarda scorecards
    API->>S: Verifica completitud
    
    S->>AI: Consolidar feedback
    AI->>AI: Analiza consenso/discrepancias
    AI->>AI: Genera resumen ejecutivo
    AI->>AI: Calcula score promedio ponderado
    AI-->>DB: Guarda an√°lisis consolidado
    
    S->>N: Notifica a Hiring Manager
    N->>HM: Email + Slack: Feedback listo para revisi√≥n
    
    HM->>API: GET /candidates/{id}/feedback-summary
    API-->>HM: Resumen ejecutivo + scorecards individuales
    
    alt Decisi√≥n: Avanzar
        HM->>API: POST /candidates/{id}/advance
        API->>DB: Actualiza stage
        API->>N: Notifica equipo
    else Decisi√≥n: Rechazar
        HM->>API: POST /candidates/{id}/reject
        API->>DB: Actualiza estado
        API->>N: Email rechazo a candidato
    else Decisi√≥n: M√°s entrevistas
        HM->>API: POST /interviews/schedule
        API->>S: Programa nueva ronda
    end
```

---

## 5. Modelo de Datos

### 5.1 Diagrama Entidad-Relaci√≥n

```mermaid
erDiagram
    ORGANIZATION ||--o{ USER : "tiene"
    ORGANIZATION ||--o{ DEPARTMENT : "tiene"
    ORGANIZATION ||--o{ JOB : "publica"
    ORGANIZATION ||--o{ CANDIDATE : "almacena"
    
    USER ||--o{ JOB : "crea"
    USER ||--o{ INTERVIEW : "realiza"
    USER ||--o{ SCORECARD : "completa"
    USER ||--o{ COMMENT : "escribe"
    USER ||--o{ ACTIVITY_LOG : "genera"
    
    DEPARTMENT ||--o{ JOB : "pertenece"
    
    JOB ||--o{ APPLICATION : "recibe"
    JOB ||--o{ JOB_POSTING : "se publica en"
    JOB ||--o{ PIPELINE_STAGE : "tiene"
    JOB ||--o{ SCORECARD_TEMPLATE : "usa"
    
    CANDIDATE ||--o{ APPLICATION : "env√≠a"
    CANDIDATE ||--o{ CANDIDATE_TAG : "tiene"
    CANDIDATE ||--o{ CANDIDATE_SOURCE : "viene de"
    CANDIDATE ||--o{ ENRICHMENT_DATA : "se enriquece con"
    
    APPLICATION ||--o{ INTERVIEW : "programa"
    APPLICATION ||--o{ SCORECARD : "eval√∫a"
    APPLICATION ||--o{ COMMENT : "recibe"
    APPLICATION ||--o{ OFFER : "genera"
    APPLICATION ||--o{ ACTIVITY_LOG : "registra"
    APPLICATION }o--|| PIPELINE_STAGE : "est√° en"
    
    INTERVIEW ||--o{ SCORECARD : "produce"
    
    OFFER ||--o{ OFFER_APPROVAL : "requiere"
    
    JOB_BOARD ||--o{ JOB_POSTING : "recibe"

    ORGANIZATION {
        uuid id PK
        string name
        string slug
        string plan_type
        jsonb settings
        timestamp created_at
        timestamp updated_at
    }
    
    USER {
        uuid id PK
        uuid organization_id FK
        string email
        string name
        string role
        string avatar_url
        jsonb preferences
        timestamp last_login_at
        timestamp created_at
    }
    
    DEPARTMENT {
        uuid id PK
        uuid organization_id FK
        string name
        uuid parent_id FK
        timestamp created_at
    }
    
    JOB {
        uuid id PK
        uuid organization_id FK
        uuid department_id FK
        uuid created_by FK
        string title
        text description
        text requirements
        string employment_type
        string location_type
        string location
        string salary_range
        string status
        integer openings
        timestamp published_at
        timestamp closed_at
        timestamp created_at
        timestamp updated_at
    }
    
    CANDIDATE {
        uuid id PK
        uuid organization_id FK
        string email
        string first_name
        string last_name
        string phone
        string linkedin_url
        string github_url
        string portfolio_url
        text resume_text
        string resume_url
        jsonb parsed_resume
        integer ai_score
        timestamp created_at
        timestamp updated_at
    }
    
    APPLICATION {
        uuid id PK
        uuid job_id FK
        uuid candidate_id FK
        uuid current_stage_id FK
        string source
        string status
        integer ai_match_score
        jsonb ai_analysis
        timestamp applied_at
        timestamp updated_at
    }
    
    PIPELINE_STAGE {
        uuid id PK
        uuid job_id FK
        string name
        integer order_index
        string stage_type
        boolean is_rejection
        jsonb automation_rules
    }
    
    INTERVIEW {
        uuid id PK
        uuid application_id FK
        uuid interviewer_id FK
        string interview_type
        timestamp scheduled_at
        integer duration_minutes
        string location
        string meeting_url
        string status
        timestamp completed_at
    }
    
    SCORECARD {
        uuid id PK
        uuid interview_id FK
        uuid application_id FK
        uuid user_id FK
        uuid template_id FK
        jsonb ratings
        text notes
        string recommendation
        integer overall_score
        timestamp submitted_at
    }
    
    SCORECARD_TEMPLATE {
        uuid id PK
        uuid job_id FK
        string name
        string interview_type
        jsonb competencies
        jsonb rating_scale
    }
    
    COMMENT {
        uuid id PK
        uuid application_id FK
        uuid user_id FK
        text content
        boolean is_private
        timestamp created_at
    }
    
    OFFER {
        uuid id PK
        uuid application_id FK
        uuid created_by FK
        decimal salary
        string currency
        date start_date
        text terms
        string status
        string document_url
        timestamp sent_at
        timestamp responded_at
    }
    
    OFFER_APPROVAL {
        uuid id PK
        uuid offer_id FK
        uuid approver_id FK
        string status
        text comments
        timestamp responded_at
    }
    
    JOB_BOARD {
        uuid id PK
        string name
        string api_type
        jsonb credentials
        boolean is_active
    }
    
    JOB_POSTING {
        uuid id PK
        uuid job_id FK
        uuid job_board_id FK
        string external_id
        string external_url
        string status
        timestamp posted_at
        timestamp expires_at
    }
    
    CANDIDATE_TAG {
        uuid id PK
        uuid candidate_id FK
        string tag_name
        string tag_color
    }
    
    CANDIDATE_SOURCE {
        uuid id PK
        uuid candidate_id FK
        string source_type
        string source_detail
        timestamp sourced_at
    }
    
    ENRICHMENT_DATA {
        uuid id PK
        uuid candidate_id FK
        string data_type
        jsonb data
        timestamp fetched_at
    }
    
    ACTIVITY_LOG {
        uuid id PK
        uuid organization_id FK
        uuid user_id FK
        uuid application_id FK
        string action_type
        jsonb metadata
        timestamp created_at
    }
```

### 5.2 Descripci√≥n de Entidades

#### Entidades Principales

| Entidad | Descripci√≥n | Atributos Clave |
|---------|-------------|-----------------|
| **ORGANIZATION** | Empresa cliente de LTI (tenant) | id, name, slug, plan_type, settings |
| **USER** | Usuario del sistema (recruiter, hiring manager, admin) | id, email, name, role, organization_id |
| **DEPARTMENT** | Departamento/√°rea de la organizaci√≥n | id, name, organization_id, parent_id |
| **JOB** | Oferta de empleo/posici√≥n abierta | id, title, description, status, department_id |
| **CANDIDATE** | Persona que aplica o es sourceada | id, email, name, resume, ai_score |
| **APPLICATION** | Candidatura de un candidato a un job espec√≠fico | id, job_id, candidate_id, status, ai_match_score |

#### Entidades de Proceso

| Entidad | Descripci√≥n | Atributos Clave |
|---------|-------------|-----------------|
| **PIPELINE_STAGE** | Etapa del proceso de selecci√≥n | id, job_id, name, order_index, automation_rules |
| **INTERVIEW** | Entrevista programada | id, application_id, interviewer_id, scheduled_at, status |
| **SCORECARD** | Evaluaci√≥n de entrevista completada | id, interview_id, ratings, recommendation, overall_score |
| **SCORECARD_TEMPLATE** | Plantilla de evaluaci√≥n por tipo de entrevista | id, job_id, competencies, rating_scale |
| **OFFER** | Oferta de trabajo generada | id, application_id, salary, status, document_url |
| **OFFER_APPROVAL** | Aprobaci√≥n requerida para oferta | id, offer_id, approver_id, status |

#### Entidades de Soporte

| Entidad | Descripci√≥n | Atributos Clave |
|---------|-------------|-----------------|
| **JOB_BOARD** | Integraci√≥n con portal de empleo externo | id, name, api_type, credentials |
| **JOB_POSTING** | Publicaci√≥n de job en job board espec√≠fico | id, job_id, job_board_id, external_url, status |
| **COMMENT** | Comentario/nota en una aplicaci√≥n | id, application_id, user_id, content, is_private |
| **CANDIDATE_TAG** | Etiqueta asignada a candidato | id, candidate_id, tag_name, tag_color |
| **CANDIDATE_SOURCE** | Origen del candidato | id, candidate_id, source_type, source_detail |
| **ENRICHMENT_DATA** | Datos externos enriquecidos (LinkedIn, GitHub) | id, candidate_id, data_type, data |
| **ACTIVITY_LOG** | Registro de actividad para auditor√≠a | id, action_type, user_id, application_id, metadata |

### 5.3 Relaciones Principales

1. **Organization ‚Üí Users/Jobs/Candidates**: Multi-tenancy donde cada organizaci√≥n tiene sus propios datos aislados.

2. **Job ‚Üí Applications ‚Üí Candidate**: Una oferta recibe m√∫ltiples aplicaciones, cada una vinculada a un candidato. Un candidato puede tener m√∫ltiples aplicaciones (a diferentes jobs).

3. **Application ‚Üí Pipeline_Stage**: Cada aplicaci√≥n est√° en exactamente una etapa del pipeline en un momento dado.

4. **Application ‚Üí Interviews ‚Üí Scorecards**: Una aplicaci√≥n puede tener m√∫ltiples entrevistas, y cada entrevista produce uno o m√°s scorecards (uno por entrevistador).

5. **Job ‚Üí Scorecard_Templates**: Cada job tiene templates de scorecard configurados para diferentes tipos de entrevista (technical, cultural, etc.).

6. **Candidate ‚Üí Enrichment_Data**: Un candidato puede tener m√∫ltiples registros de enriquecimiento de diferentes fuentes (LinkedIn, GitHub, etc.).

---

## 6. Dise√±o del Sistema a Alto Nivel

### 6.1 Descripci√≥n de la Arquitectura

LTI sigue una arquitectura de **microservicios moderada** con un **API Gateway** como punto de entrada √∫nico. Esta decisi√≥n balancea la simplicidad de un monolito (apropiada para una startup) con la flexibilidad de escalar componentes cr√≠ticos de forma independiente.

**Principios arquitect√≥nicos:**

1. **API-First**: Toda funcionalidad se expone a trav√©s de APIs RESTful documentadas, permitiendo integraciones y un frontend desacoplado.

2. **Event-Driven para procesos as√≠ncronos**: Operaciones como parsing de CVs, enriquecimiento de datos y notificaciones se manejan mediante colas de mensajes.

3. **Multi-tenancy con Row Level Security**: Base de datos compartida con aislamiento a nivel de fila usando pol√≠ticas de PostgreSQL.

4. **Separation of Concerns**: El AI Service es independiente para poder escalar seg√∫n demanda y actualizar modelos sin afectar el core.

**Componentes principales:**

- **API Gateway**: Autenticaci√≥n, rate limiting, routing y logging centralizado.
- **Core API**: L√≥gica de negocio principal (jobs, candidates, applications, interviews).
- **AI Service**: Procesamiento de IA (parsing CVs, scoring, generaci√≥n de contenido, AI Agent).
- **Integration Service**: Conexiones con sistemas externos (job boards, calendarios, HRIS).
- **Notification Service**: Gesti√≥n de emails, push notifications y webhooks.
- **Real-time Service**: WebSockets para actualizaciones en tiempo real y colaboraci√≥n.

### 6.2 Diagrama de Arquitectura

```mermaid
flowchart TB
    subgraph clients["Clientes"]
        WEB["üåê Web App<br/>(Next.js)"]
        MOBILE["üì± Mobile App<br/>(React Native)"]
        SLACK["üí¨ Slack Bot"]
        EXT_API["üîå API Externa<br/>(Integraciones)"]
    end
    
    subgraph edge["Edge Layer"]
        CDN["‚òÅÔ∏è CDN<br/>(CloudFront)"]
        LB["‚öñÔ∏è Load Balancer<br/>(ALB)"]
    end
    
    subgraph gateway["API Gateway Layer"]
        APIGW["üö™ API Gateway<br/>(Kong/AWS API GW)"]
        AUTH["üîê Auth Service<br/>(Clerk/Auth0)"]
    end
    
    subgraph services["Application Services"]
        CORE["üìã Core API<br/>(NestJS)"]
        AI["ü§ñ AI Service<br/>(Python/FastAPI)"]
        INTEGRATION["üîó Integration Service<br/>(NestJS)"]
        NOTIFICATION["üìß Notification Service<br/>(NestJS)"]
        REALTIME["‚ö° Real-time Service<br/>(Socket.io)"]
    end
    
    subgraph ai_components["AI Components"]
        LLM["üß† LLM Provider<br/>(OpenAI/Anthropic)"]
        PARSER["üìÑ CV Parser<br/>(Custom NLP)"]
        SCORER["üìä Match Scorer<br/>(ML Model)"]
        AGENT["ü§ñ AI Agent<br/>(Autonomous)"]
    end
    
    subgraph data["Data Layer"]
        PG[("üêò PostgreSQL<br/>(Primary DB)")]
        REDIS[("‚ö° Redis<br/>(Cache/Sessions)")]
        ES[("üîç OpenSearch<br/>(Full-text Search)")]
        S3["üìÅ S3<br/>(File Storage)"]
    end
    
    subgraph queue["Message Queue"]
        BULL["üì¨ BullMQ<br/>(Job Queue)"]
    end
    
    subgraph external["Servicios Externos"]
        LINKEDIN["LinkedIn API"]
        INDEED["Indeed API"]
        GMAIL["Gmail/Calendar"]
        GITHUB["GitHub API"]
    end
    
    %% Client connections
    WEB --> CDN
    MOBILE --> CDN
    SLACK --> LB
    EXT_API --> LB
    CDN --> LB
    LB --> APIGW
    
    %% Gateway connections
    APIGW --> AUTH
    APIGW --> CORE
    APIGW --> REALTIME
    
    %% Service connections
    CORE --> PG
    CORE --> REDIS
    CORE --> ES
    CORE --> S3
    CORE --> BULL
    
    AI --> LLM
    AI --> PARSER
    AI --> SCORER
    AI --> AGENT
    AI --> PG
    AI --> REDIS
    
    INTEGRATION --> external
    INTEGRATION --> BULL
    
    NOTIFICATION --> BULL
    
    REALTIME --> REDIS
    
    %% Queue connections
    BULL --> AI
    BULL --> INTEGRATION
    BULL --> NOTIFICATION
    
    %% Styling
    classDef clientStyle fill:#e1f5fe,stroke:#01579b
    classDef edgeStyle fill:#f3e5f5,stroke:#7b1fa2
    classDef gatewayStyle fill:#fff3e0,stroke:#e65100
    classDef serviceStyle fill:#e8f5e9,stroke:#2e7d32
    classDef aiStyle fill:#fce4ec,stroke:#c2185b
    classDef dataStyle fill:#e0f2f1,stroke:#00695c
    classDef queueStyle fill:#fff8e1,stroke:#f57f17
    classDef externalStyle fill:#f5f5f5,stroke:#616161
    
    class WEB,MOBILE,SLACK,EXT_API clientStyle
    class CDN,LB edgeStyle
    class APIGW,AUTH gatewayStyle
    class CORE,AI,INTEGRATION,NOTIFICATION,REALTIME serviceStyle
    class LLM,PARSER,SCORER,AGENT aiStyle
    class PG,REDIS,ES,S3 dataStyle
    class BULL queueStyle
    class LINKEDIN,INDEED,GMAIL,GITHUB externalStyle
```

### 6.3 Descripci√≥n de Componentes

#### Frontend Layer
- **Web App (Next.js)**: SPA con SSR para SEO en career sites. Dashboard principal para recruiters.
- **Mobile App (React Native)**: Versi√≥n m√≥vil para gesti√≥n on-the-go, notificaciones push, quick actions.
- **Slack Bot**: Interfaz conversacional para aprobar candidatos, dar feedback, recibir alertas.

#### Edge Layer
- **CDN (CloudFront)**: Cach√© de assets est√°ticos, career sites, y respuestas de API frecuentes.
- **Load Balancer (ALB)**: Distribuci√≥n de tr√°fico, health checks, terminaci√≥n SSL.

#### Gateway Layer
- **API Gateway**: Punto de entrada √∫nico. Rate limiting por tenant, logging centralizado, routing.
- **Auth Service**: Autenticaci√≥n (email, Google, SSO SAML), gesti√≥n de sesiones, RBAC.

#### Application Services
- **Core API**: CRUD de entidades principales, l√≥gica de negocio, validaciones, permisos.
- **AI Service**: Procesamiento de IA aislado para escalar independientemente.
- **Integration Service**: Conectores con sistemas externos, manejo de webhooks entrantes/salientes.
- **Notification Service**: Templates de email, env√≠o multicanal, preferencias de usuario.
- **Real-time Service**: WebSockets para actualizaciones live, presencia, colaboraci√≥n.

#### Data Layer
- **PostgreSQL**: Base de datos principal con Row Level Security para multi-tenancy.
- **Redis**: Cache de sesiones, rate limiting, pub/sub para real-time.
- **OpenSearch**: B√∫squeda full-text de candidatos, jobs, notas.
- **S3**: Almacenamiento de CVs, documentos, archivos adjuntos.

#### Message Queue
- **BullMQ**: Cola de trabajos para procesos as√≠ncronos (parsing, emails, integraciones).

---

## 7. Diagrama C4 - Componente de IA

He seleccionado el **AI Service** para el diagrama C4 en profundidad porque es el componente m√°s diferenciador y complejo de LTI.

### 7.1 C4 - Nivel 1: Contexto del Sistema

```mermaid
flowchart TB
    subgraph boundary[" "]
        LTI["üè¢ LTI System<br/><br/>ATS con IA nativa para<br/>startups en crecimiento"]
    end
    
    RECRUITER["üë§ Recruiter<br/><br/>Publica ofertas, gestiona<br/>candidatos, realiza entrevistas"]
    CANDIDATE["üë§ Candidato<br/><br/>Aplica a ofertas,<br/>completa assessments"]
    HM["üë§ Hiring Manager<br/><br/>Revisa candidatos,<br/>aprueba ofertas"]
    
    LINKEDIN["üîó LinkedIn<br/><br/>Sourcing de candidatos,<br/>publicaci√≥n de ofertas"]
    JOBBOARDS["üìã Job Boards<br/><br/>Indeed, Glassdoor,<br/>portales especializados"]
    CALENDAR["üìÖ Calendar<br/><br/>Google Calendar,<br/>Outlook"]
    LLM_EXT["üß† LLM Providers<br/><br/>OpenAI, Anthropic<br/>para generaci√≥n de IA"]
    
    RECRUITER -->|"Gestiona proceso<br/>de selecci√≥n"| LTI
    CANDIDATE -->|"Aplica y<br/>entrevista"| LTI
    HM -->|"Revisa y<br/>decide"| LTI
    
    LTI -->|"Sourcea candidatos<br/>publica ofertas"| LINKEDIN
    LTI -->|"Publica ofertas<br/>recibe aplicaciones"| JOBBOARDS
    LTI -->|"Programa<br/>entrevistas"| CALENDAR
    LTI -->|"Genera contenido<br/>analiza CVs"| LLM_EXT
    
    style LTI fill:#1168bd,stroke:#0b4884,color:white
    style RECRUITER fill:#08427b,stroke:#052e56,color:white
    style CANDIDATE fill:#08427b,stroke:#052e56,color:white
    style HM fill:#08427b,stroke:#052e56,color:white
    style LINKEDIN fill:#999999,stroke:#666666,color:white
    style JOBBOARDS fill:#999999,stroke:#666666,color:white
    style CALENDAR fill:#999999,stroke:#666666,color:white
    style LLM_EXT fill:#999999,stroke:#666666,color:white
```

### 7.2 C4 - Nivel 2: Contenedores

```mermaid
flowchart TB
    subgraph users["Usuarios"]
        RECRUITER["üë§ Recruiter"]
        HM["üë§ Hiring Manager"]
    end
    
    subgraph lti["LTI System"]
        WEB["üåê Web Application<br/><br/>Next.js, TypeScript<br/>Dashboard de reclutamiento"]
        
        APIGW["üö™ API Gateway<br/><br/>Kong<br/>Routing, Auth, Rate Limiting"]
        
        CORE["üìã Core API<br/><br/>NestJS, TypeScript<br/>L√≥gica de negocio principal"]
        
        AI_SVC["ü§ñ AI Service<br/><br/>Python, FastAPI<br/>Procesamiento de IA"]
        
        NOTIF["üìß Notification Service<br/><br/>NestJS<br/>Emails, Push, Webhooks"]
        
        PG[("üêò PostgreSQL<br/><br/>Base de datos principal")]
        
        REDIS[("‚ö° Redis<br/><br/>Cache, Colas")]
        
        S3["üìÅ S3<br/><br/>Archivos, CVs"]
    end
    
    subgraph external["Sistemas Externos"]
        LLM["üß† OpenAI/Anthropic"]
        LINKEDIN["üîó LinkedIn API"]
        GITHUB["üêô GitHub API"]
    end
    
    RECRUITER -->|"HTTPS"| WEB
    HM -->|"HTTPS"| WEB
    
    WEB -->|"JSON/HTTPS"| APIGW
    APIGW -->|"JSON/HTTPS"| CORE
    APIGW -->|"JSON/HTTPS"| AI_SVC
    
    CORE -->|"SQL"| PG
    CORE -->|"Pub/Sub"| REDIS
    CORE -->|"Async Jobs"| AI_SVC
    CORE -->|"Events"| NOTIF
    
    AI_SVC -->|"SQL"| PG
    AI_SVC -->|"Cache"| REDIS
    AI_SVC -->|"Files"| S3
    AI_SVC -->|"API Calls"| LLM
    AI_SVC -->|"API Calls"| LINKEDIN
    AI_SVC -->|"API Calls"| GITHUB
    
    NOTIF -->|"SQL"| PG
    
    style WEB fill:#438dd5,stroke:#2e6295,color:white
    style APIGW fill:#438dd5,stroke:#2e6295,color:white
    style CORE fill:#438dd5,stroke:#2e6295,color:white
    style AI_SVC fill:#438dd5,stroke:#2e6295,color:white
    style NOTIF fill:#438dd5,stroke:#2e6295,color:white
    style PG fill:#438dd5,stroke:#2e6295,color:white
    style REDIS fill:#438dd5,stroke:#2e6295,color:white
    style S3 fill:#438dd5,stroke:#2e6295,color:white
```

### 7.3 C4 - Nivel 3: Componentes del AI Service

```mermaid
flowchart TB
    subgraph external_in["Entradas"]
        CORE_API["üìã Core API"]
        QUEUE["üì¨ Job Queue<br/>(BullMQ)"]
    end
    
    subgraph ai_service["AI Service (Python/FastAPI)"]
        
        subgraph api_layer["API Layer"]
            ROUTER["üö¶ API Router<br/><br/>FastAPI endpoints<br/>Validaci√≥n de requests"]
            WORKER["‚öôÔ∏è Queue Worker<br/><br/>Procesa jobs async<br/>Retry logic"]
        end
        
        subgraph processing["Processing Components"]
            CV_PARSER["üìÑ CV Parser<br/><br/>Extrae datos estructurados<br/>de CVs (PDF, DOCX)"]
            
            ENRICHER["üîç Profile Enricher<br/><br/>Obtiene datos de LinkedIn,<br/>GitHub, portfolio"]
            
            SCORER["üìä Match Scorer<br/><br/>Eval√∫a fit candidato-job<br/>ML + heur√≠sticas"]
            
            GENERATOR["‚úçÔ∏è Content Generator<br/><br/>Genera JDs, emails,<br/>preguntas entrevista"]
            
            AGENT["ü§ñ AI Agent<br/><br/>Sourcing aut√≥nomo<br/>Outreach automatizado"]
        end
        
        subgraph llm_layer["LLM Abstraction Layer"]
            LLM_CLIENT["üß† LLM Client<br/><br/>Abstracci√≥n multi-provider<br/>OpenAI, Anthropic, local"]
            
            PROMPT_MGR["üìù Prompt Manager<br/><br/>Templates versionados<br/>A/B testing"]
            
            CACHE["üíæ Response Cache<br/><br/>Cachea respuestas<br/>similares"]
        end
        
        subgraph data_layer["Data Layer"]
            REPO["üóÉÔ∏è Repository<br/><br/>Acceso a PostgreSQL<br/>SQLAlchemy"]
            
            VECTOR_STORE["üéØ Vector Store<br/><br/>Embeddings de candidatos<br/>B√∫squeda sem√°ntica"]
            
            FILE_STORE["üìÅ File Store<br/><br/>Acceso a S3<br/>CVs procesados"]
        end
    end
    
    subgraph external_out["Servicios Externos"]
        OPENAI["OpenAI API"]
        ANTHROPIC["Anthropic API"]
        LINKEDIN["LinkedIn API"]
        GITHUB["GitHub API"]
        PG[("PostgreSQL")]
        S3["S3"]
    end
    
    %% Input connections
    CORE_API -->|"HTTP sync"| ROUTER
    QUEUE -->|"Job events"| WORKER
    
    %% Router connections
    ROUTER --> CV_PARSER
    ROUTER --> SCORER
    ROUTER --> GENERATOR
    
    %% Worker connections
    WORKER --> CV_PARSER
    WORKER --> ENRICHER
    WORKER --> AGENT
    
    %% Processing to LLM
    CV_PARSER --> LLM_CLIENT
    SCORER --> LLM_CLIENT
    GENERATOR --> LLM_CLIENT
    AGENT --> LLM_CLIENT
    
    %% LLM layer connections
    LLM_CLIENT --> PROMPT_MGR
    LLM_CLIENT --> CACHE
    
    %% Processing to Data
    CV_PARSER --> REPO
    CV_PARSER --> FILE_STORE
    ENRICHER --> REPO
    SCORER --> VECTOR_STORE
    AGENT --> REPO
    
    %% External connections
    LLM_CLIENT --> OPENAI
    LLM_CLIENT --> ANTHROPIC
    ENRICHER --> LINKEDIN
    ENRICHER --> GITHUB
    REPO --> PG
    FILE_STORE --> S3
    
    %% Styling
    classDef apiStyle fill:#6c8ebf,stroke:#5a7aa8,color:white
    classDef processingStyle fill:#82b366,stroke:#6d9b51,color:white
    classDef llmStyle fill:#d79b00,stroke:#b88200,color:white
    classDef dataStyle fill:#b85450,stroke:#9c4641,color:white
    classDef externalStyle fill:#f5f5f5,stroke:#666666
    
    class ROUTER,WORKER apiStyle
    class CV_PARSER,ENRICHER,SCORER,GENERATOR,AGENT processingStyle
    class LLM_CLIENT,PROMPT_MGR,CACHE llmStyle
    class REPO,VECTOR_STORE,FILE_STORE dataStyle
```

### 7.4 Descripci√≥n de Componentes del AI Service

#### API Layer

| Componente | Responsabilidad | Tecnolog√≠a |
|------------|-----------------|------------|
| **API Router** | Endpoints REST para operaciones s√≠ncronas (scoring r√°pido, generaci√≥n de contenido). Validaci√≥n con Pydantic. | FastAPI |
| **Queue Worker** | Procesa jobs as√≠ncronos de la cola (parsing de CVs, enriquecimiento, AI Agent). Maneja retries y dead-letter queue. | BullMQ + Python |

#### Processing Components

| Componente | Responsabilidad | Input ‚Üí Output |
|------------|-----------------|----------------|
| **CV Parser** | Extrae datos estructurados de CVs en m√∫ltiples formatos. Usa OCR si es necesario. | PDF/DOCX ‚Üí JSON estructurado |
| **Profile Enricher** | Obtiene datos adicionales de fuentes p√∫blicas (LinkedIn, GitHub). Unifica en perfil √∫nico. | Candidate ID ‚Üí Enriched Profile |
| **Match Scorer** | Calcula score de compatibilidad candidato-job. Combina ML (embeddings) con reglas de negocio. | (Candidate, Job) ‚Üí Score 0-100 |
| **Content Generator** | Genera contenido usando LLMs: JDs, emails de outreach, preguntas de entrevista. | Prompt + Context ‚Üí Generated Text |
| **AI Agent** | Agente aut√≥nomo que ejecuta workflows de sourcing: busca ‚Üí filtra ‚Üí contacta ‚Üí agenda. | Job Requirements ‚Üí Sourced Candidates |

#### LLM Abstraction Layer

| Componente | Responsabilidad | Beneficio |
|------------|-----------------|-----------|
| **LLM Client** | Abstracci√≥n sobre m√∫ltiples providers (OpenAI, Anthropic, modelos locales). Fallback autom√°tico. | Evita vendor lock-in |
| **Prompt Manager** | Gestiona templates de prompts versionados. Permite A/B testing de prompts. | Iteraci√≥n r√°pida |
| **Response Cache** | Cachea respuestas para prompts id√©nticos/similares. TTL configurable por tipo. | Reduce costes de API |

#### Data Layer

| Componente | Responsabilidad | Tecnolog√≠a |
|------------|-----------------|------------|
| **Repository** | Acceso a base de datos principal. Implementa patr√≥n repository con SQLAlchemy. | PostgreSQL |
| **Vector Store** | Almacena y busca embeddings de candidatos para b√∫squeda sem√°ntica y matching. | pgvector / Pinecone |
| **File Store** | Gestiona archivos (CVs originales, procesados, reportes). Interface sobre S3. | AWS S3 |

### 7.5 Flujos de Datos Principales

**Flujo 1: Parsing de CV (As√≠ncrono)**
```
1. Core API encola job "parse_cv" con file_id
2. Queue Worker recibe job
3. File Store descarga CV de S3
4. CV Parser extrae texto (PyPDF2/python-docx)
5. LLM Client env√≠a a OpenAI para estructuraci√≥n
6. Repository guarda datos parseados en PostgreSQL
7. Vector Store genera y almacena embedding del candidato
8. Worker marca job como completado
```

**Flujo 2: Generaci√≥n de Job Description (S√≠ncrono)**
```
1. Core API llama a POST /ai/generate-jd con t√≠tulo y contexto
2. API Router valida request
3. Content Generator construye prompt con Prompt Manager
4. Cache verifica si existe respuesta cacheada
5. LLM Client llama a OpenAI/Anthropic
6. Response se cachea y retorna al Core API
```

**Flujo 3: AI Agent Sourcing (Aut√≥nomo)**
```
1. Job programado trigger cada 6 horas para jobs activos
2. AI Agent recibe job requirements
3. Agent busca en LinkedIn via API (o scraping autorizado)
4. Match Scorer eval√∫a cada candidato encontrado
5. Content Generator crea outreach personalizado
6. Agent env√≠a mensajes via LinkedIn/email
7. Repository registra candidatos sourceados
8. Notification Service alerta al recruiter de hot leads
```

---

## Anexo: Stack Tecnol√≥gico Recomendado

### Backend
- **Runtime**: Node.js 20 LTS
- **Framework**: NestJS 10 (TypeScript)
- **AI Service**: Python 3.11 + FastAPI
- **ORM**: Prisma (Node), SQLAlchemy (Python)

### Frontend
- **Framework**: Next.js 14 (App Router)
- **UI**: shadcn/ui + Tailwind CSS
- **State**: TanStack Query + Zustand
- **Real-time**: Socket.io client

### Data
- **Primary DB**: PostgreSQL 16 con pgvector
- **Cache**: Redis 7
- **Search**: OpenSearch
- **Storage**: AWS S3

### Infrastructure
- **Cloud**: AWS (alternativa: GCP)
- **Containers**: Docker + ECS Fargate
- **CI/CD**: GitHub Actions
- **Monitoring**: Datadog / Grafana

### AI/ML
- **LLM Primary**: OpenAI GPT-4o
- **LLM Fallback**: Anthropic Claude
- **Embeddings**: OpenAI text-embedding-3-large
- **CV Parsing**: Custom + LLM enhancement

---

*Documento generado para el ejercicio de dise√±o de sistemas - LTI ATS*
*Autor: Pablo (LTI-PBL)*
*Fecha: Noviembre 2025*
